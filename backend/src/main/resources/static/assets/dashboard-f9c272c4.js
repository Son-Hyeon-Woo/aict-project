import{u as w}from"./index-c261a835.js";import{d as O}from"./pinia-f5faf949.js";import{r as d,aN as D,aR as C,o as b,k as S,l as t,e,u as l,d as E,v as U,ae as F,b as A,F as V,m as f,B as x,x as z}from"./@vue-358a9f7c.js";import{V as T}from"./vue3-apexcharts-8c5f8464.js";import{a as B}from"./layout-with-vertical-nav_v240827-238b02e6.js";import{p,q as v,r as k,s as y}from"./vuetify-3470be6c.js";import{A as W}from"./agGridTable-e1520360.js";import"./@iconify-319cce74.js";import"./vue-router-c26e01f6.js";import"./axios-9d43f49d.js";import"./apexcharts-clevision-bbcd5403.js";import"./axios-mock-adapter-5e48edef.js";import"./fast-deep-equal-6efe4724.js";import"./is-buffer-7d84b7d6.js";import"./vue-demi-71ba0ef2.js";import"./vue-e8b4e3e8.js";import"./vue3-perfect-scrollbar-ac907acf.js";import"./perfect-scrollbar-c9c56521.js";import"./@vueuse-36fea5a4.js";import"./ag-grid-community-afd81849.js";import"./ag-grid-vue3-6356d667.js";const I=O("updateTime",()=>{const g=d(null),i=d(null),u=d(null),n=d(null);return{timeBasedDetection:g,todayDetection:i,detectionCategory:u,weeklyDetection:n,setTimeBasedDetectionUpdateTime:a=>{g.value=a},setTodayDetectionUpdateTime:a=>{i.value=a},setDetectionCategoryUpdateTime:a=>{u.value=a},setWeeklyDetectionUpdateTime:a=>{n.value=a}}});const N={__name:"DetectionCategoryChart",setup(g){const u=w().getAxiosInstance();let n=null;const c=I(),s=d([{data:[0,0,0,0,0]}]),o=d({chart:{height:350,type:"bar",events:{click:function(a,m,h){}}},colors:["#FF6B6B","#4ECDC4","#45B7D1","#FFA07A","#98D8C8"],plotOptions:{bar:{columnWidth:"45%",distributed:!0}},dataLabels:{enabled:!1},legend:{show:!1},xaxis:{categories:[["John","Doe"],["Joe","Smith"],["Jake","Williams"],["Peter","Brown"],["Mary","Evans"]],labels:{style:{colors:["#FF6B6B","#4ECDC4","#45B7D1","#FFA07A","#98D8C8"],fontSize:"12px"}}}});async function r(){const a=await u.get("count-by-risk-detail");s.value[0].data=Object.values(a.data.data.emailCountByRiskDetail),o.value={...o.value,xaxis:{...o.value.xaxis,categories:Object.keys(a.data.data.emailCountByRiskDetail)}},c.setDetectionCategoryUpdateTime(a.data.data.lastUpdateTime)}return D(()=>{r(),n=setInterval(r,1e4)}),C(()=>{n&&clearInterval(n)}),(a,m)=>(b(),S(v,null,{default:t(()=>[e(p,{cols:"12",class:"pt-0"},{default:t(()=>[e(l(T),{type:"bar",options:l(o),series:l(s)},null,8,["options","series"])]),_:1})]),_:1}))}},L=B(N,[["__scopeId","data-v-d2236116"]]);const R={__name:"RiskEmailList",setup(g){let i=null;const n=w().getAxiosInstance(),c=d([]),s=d([{headerName:"제목",field:"title",headerClass:"font-size-9 font-weight-bold bg-lightred",cellStyle:{"text-align":"center"}},{headerName:"위험도",field:"riskLevel",headerClass:"font-size-9 font-weight-bold bg-lightred",cellStyle:{"text-align":"center"}},{headerName:"위험유형",field:"riskDetail",headerClass:"font-size-9 font-weight-bold bg-lightred",cellStyle:{"text-align":"center"}},{headerName:"차단일자",field:"detectionDate",headerClass:"font-size-9 font-weight-bold bg-lightred",cellStyle:{"text-align":"center"}}]),o=async()=>{try{const r=await n.get("last-10-blocked-emails");c.value=r.data.data.emails}catch(r){console.error("Error fetching data:",r)}};return D(()=>{o(),i=setInterval(o,1e4)}),C(()=>{i&&clearInterval(i)}),(r,a)=>(b(),S(v,null,{default:t(()=>[e(p,{cols:"12"},{default:t(()=>[e(W,{"row-data":l(c),"col-defs":l(s),height:"calc(100vh - 39rem)","pagination-page-size":5,"pagination-page-size-selector":[5],"loading-message":"데이터 로딩 중...","fetch-data":o},null,8,["row-data","col-defs"])]),_:1})]),_:1}))}};const $={__name:"TimeBasedDetection",setup(g){const u=w().getAxiosInstance();let n=null;const c=I(),s=d([{name:"금일",data:[0,0,0,0,0,0,0,0,0,0]},{name:"전일",data:[0,0,0,0,0,0,0,0,0,0]}]),o=d({chart:{height:350,type:"area",toolbar:{show:!1}},dataLabels:{enabled:!1},stroke:{curve:"smooth"},xaxis:{type:"time",categories:["09:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00"]},tooltip:{x:{format:"HH:mm"}}}),r=async()=>{try{const a=await u.get("hourly-detected-emails");s.value[0].data=a.data.data.series[0].data,s.value[1].data=a.data.data.series[1].data;const m=a.data.data.categories.map(h=>h.split(" ")[1]);o.value={...o.value,xaxis:{...o.value.xaxis,categories:m}},c.setTimeBasedDetectionUpdateTime(a.data.data.lastUpdateTime)}catch(a){console.error("Error fetching data:",a)}};return D(()=>{r(),n=setInterval(r,7e3)}),C(()=>{n&&clearInterval(n)}),(a,m)=>(b(),S(v,null,{default:t(()=>[e(p,{cols:"12",class:"pt-0"},{default:t(()=>[e(l(T),{type:"area",options:l(o),series:l(s)},null,8,["options","series"])]),_:1})]),_:1}))}},M=B($,[["__scopeId","data-v-96bd2aa8"]]),P={xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24"},Y=F('<g fill="none" stroke="currentColor" stroke-dasharray="12" stroke-dashoffset="12" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.6"><path d="M22 12l-7 -7M22 12l-7 7"><animate fill="freeze" attributeName="stroke-dashoffset" dur="0.3s" values="12;0"></animate></path><path d="M16 12l-7 -7M16 12l-7 7"><animate fill="freeze" attributeName="stroke-dashoffset" begin="0.3s" dur="0.3s" values="12;0"></animate></path><path d="M10 12l-7 -7M10 12l-7 7"><animate fill="freeze" attributeName="stroke-dashoffset" begin="0.6s" dur="0.3s" values="12;0"></animate></path></g>',1),H=[Y],J=E({__name:"TripleArrow",setup(g){return(i,u)=>(b(),U("svg",P,H))}});const X={__name:"TodayDetection",setup(g){const u=w().getAxiosInstance(),n=I();let c=null;const s=d({total:0,detected:0,blocked:0}),o=A(()=>[s.value.detected,s.value.total-s.value.detected]),r=d({chart:{type:"donut"},dataLabels:{enabled:!1},legend:{show:!1},plotOptions:{pie:{startAngle:0,endAngle:360,expandOnClick:!0,offsetX:0,offsetY:0,customScale:1,donut:{labels:{show:!0,total:{show:!0,showAlways:!0,label:"탐지",fontWeight:600,fontFamily:"Pretendard Variable",fontSize:"1.2rem",formatter:function(_){return s.value.detected}},value:{show:!0,fontWeight:600,fontFamily:"Pretendard Variable",fontSize:"1rem",offsetY:0}}}}},labels:["탐지",""],colors:["#70dc61","#00000020"],responsive:[{breakpoint:480,options:{chart:{width:200}}}]}),a=A(()=>[s.value.blocked,s.value.detected-s.value.blocked]),m=d({chart:{type:"donut"},dataLabels:{enabled:!1},legend:{show:!1},plotOptions:{pie:{startAngle:0,endAngle:360,expandOnClick:!0,offsetX:0,offsetY:0,donut:{labels:{show:!0,total:{show:!0,showAlways:!0,label:"차단",fontWeight:600,fontFamily:"Pretendard Variable",fontSize:"1rem",formatter:function(_){return s.value.blocked}},value:{show:!0,fontWeight:600,fontFamily:"Pretendard Variable",fontSize:"1rem",offsetY:0}}}}},labels:["탐지",""],colors:["#C13030","#00000020"],responsive:[{breakpoint:480,options:{chart:{width:200}}}]}),h=async()=>{try{const _=await u.get("today-detected-emails");s.value.total=_.data.data.totalEmails,s.value.detected=_.data.data.highRiskEmails,s.value.blocked=_.data.data.blockedHighRiskEmails,n.setTodayDetectionUpdateTime(_.data.data.lastUpdateTime)}catch(_){console.error("Error fetching data:",_)}};return D(()=>{h(),c=setInterval(h,5e3)}),C(()=>{c&&clearInterval(c)}),(_,j)=>(b(),S(v,{"no-gutters":""},{default:t(()=>[e(p,{cols:"6",class:"d-flex align-center justify-center"},{default:t(()=>[e(l(T),{type:"donut",width:"100%",options:l(r),series:l(o)},null,8,["options","series"])]),_:1}),e(p,{cols:"1",class:"d-flex align-center justify-center pa-0"},{default:t(()=>[e(J,{style:{width:"100px",height:"100px"}})]),_:1}),e(p,{cols:"5",class:"d-flex align-center justify-center"},{default:t(()=>[e(l(T),{type:"donut",width:"100%",options:l(m),series:l(a)},null,8,["options","series"])]),_:1})]),_:1}))}},q=B(X,[["__scopeId","data-v-fed42a6b"]]);const G={__name:"WeeklyDetection",setup(g){const u=w().getAxiosInstance(),n=I();let c=null;const s=d([{data:[0,0,0,0,0,0,0]}]),o=d({chart:{type:"line",height:200,zoom:{enabled:!1}},dataLabels:{enabled:!0},stroke:{curve:"straight"},grid:{row:{colors:["#f3f3f3","transparent"],opacity:.5}},xaxis:{categories:[]},legend:{show:!1}}),r=async()=>{try{const a=await u.get("count-by-risk-detail-last-7-days"),m=Object.entries(a.data.data.emailCountByRiskDetail).sort(([h],[_])=>new Date(h)-new Date(_)).reduce((h,[_,j])=>(h[_]=j,h),{});s.value[0].data=Object.values(m),o.value={...o.value,xaxis:{...o.value.xaxis,categories:Object.keys(m)}},n.setWeeklyDetectionUpdateTime(a.data.data.lastUpdateTime)}catch(a){console.error("Error fetching data:",a)}};return D(()=>{r(),c=setInterval(r,5e3)}),C(()=>{c&&clearInterval(c)}),(a,m)=>(b(),S(v,{"no-gutters":""},{default:t(()=>[e(p,{cols:"12",class:"pt-0"},{default:t(()=>[e(l(T),{type:"line",height:"280",options:l(o),series:l(s)},null,8,["options","series"])]),_:1})]),_:1}))}},K=B(G,[["__scopeId","data-v-dc8e092b"]]);const Q={class:"d-flex align-center justify-center"},Z={class:"d-flex align-center justify-center flex-grow-1"},ee={class:"d-flex align-center justify-center"},te={class:"d-flex align-center justify-center"},ae={class:"d-flex align-center justify-center flex-grow-1"},se={class:"d-flex align-center justify-center"},oe={class:"d-flex align-center justify-center"},le={class:"d-flex align-center justify-center flex-grow-1"},ne={class:"d-flex align-center justify-center"},ie={class:"d-flex align-center justify-center"},re={class:"d-flex align-center justify-center flex-grow-1"},ce={class:"d-flex align-center justify-center"},de={class:"d-flex align-center justify-center flex-grow-1"},fe={class:"d-flex align-center justify-center"},ue={__name:"dashboard",setup(g){w();const i=I();return D(()=>{}),(u,n)=>(b(),U(V,null,[e(v,null,{default:t(()=>[e(p,{sm:"12",md:"4",class:"d-flex flex-column"},{default:t(()=>[e(k,{class:"pa-4 elevation-12 rounded flex-grow-1 d-flex flex-column"},{default:t(()=>[f("div",Q,[e(y,{style:{"font-size":"1.2rem","font-weight":"700",color:"#00000095"}},{default:t(()=>[x("금일 탐지/차단 현황")]),_:1})]),f("div",Z,[e(q)]),f("div",ee,[e(y,{style:{"font-size":"0.9rem","font-weight":"700",color:"#00000075"}},{default:t(()=>[x(" 마지막 업데이트 시간: "+z(l(i).todayDetection),1)]),_:1})])]),_:1})]),_:1}),e(p,{sm:"12",md:"4",class:"d-flex flex-column"},{default:t(()=>[e(k,{class:"pa-4 elevation-12 rounded flex-grow-1"},{default:t(()=>[f("div",te,[e(y,{style:{"font-size":"1.2rem","font-weight":"700",color:"#00000095"}},{default:t(()=>[x("금일/전일 위협메일 탐지 추이")]),_:1})]),f("div",ae,[e(M)]),f("div",se,[e(y,{style:{"font-size":"0.9rem","font-weight":"700",color:"#00000075"}},{default:t(()=>[x(" 마지막 업데이트 시간: "+z(l(i).timeBasedDetection),1)]),_:1})])]),_:1})]),_:1}),e(p,{sm:"12",md:"4",class:"d-flex flex-column"},{default:t(()=>[e(k,{class:"pa-4 elevation-12 rounded flex-grow-1"},{default:t(()=>[f("div",oe,[e(y,{style:{"font-size":"1.2rem","font-weight":"700",color:"#00000095"}},{default:t(()=>[x("금일 위협메일 유형별 통계")]),_:1})]),f("div",le,[e(L)]),f("div",ne,[e(y,{style:{"font-size":"0.9rem","font-weight":"700",color:"#00000075"}},{default:t(()=>[x(" 마지막 업데이트 시간: "+z(l(i).detectionCategory),1)]),_:1})])]),_:1})]),_:1})]),_:1}),e(v,null,{default:t(()=>[e(p,{sm:"12",md:"7",class:"d-flex flex-column"},{default:t(()=>[e(k,{class:"pa-4 elevation-12 rounded flex-grow-1 d-flex flex-column"},{default:t(()=>[f("div",ie,[e(y,{style:{"font-size":"1.2rem","font-weight":"700",color:"#00000095"}},{default:t(()=>[x("실시간 차단 메일 리스트")]),_:1})]),f("div",re,[e(R)])]),_:1})]),_:1}),e(p,{sm:"12",md:"5",class:"d-flex flex-column"},{default:t(()=>[e(k,{class:"pa-4 elevation-12 rounded flex-grow-1 d-flex flex-column"},{default:t(()=>[f("div",ce,[e(y,{style:{"font-size":"1.2rem","font-weight":"700",color:"#00000095"}},{default:t(()=>[x("최근 7일 탐지 추이")]),_:1})]),f("div",de,[e(K)]),f("div",fe,[e(y,{style:{"font-size":"0.9rem","font-weight":"700",color:"#00000075"}},{default:t(()=>[x(" 마지막 업데이트 시간: "+z(l(i).weeklyDetection),1)]),_:1})])]),_:1})]),_:1})]),_:1})],64))}},Oe=B(ue,[["__scopeId","data-v-668c7046"]]);export{Oe as default};

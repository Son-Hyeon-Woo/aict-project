import{u as S}from"./index-59646dff.js";import{d as F}from"./pinia-f5faf949.js";import{r as u,aN as b,aR as z,o as y,k as w,l as t,e,u as l,B as g,aE as V,b6 as E,d as O,v as j,ae as N,b as I,F as U,m as _,x as B}from"./@vue-358a9f7c.js";import{V as T}from"./vue3-apexcharts-8c5f8464.js";import{a as D}from"./layout-with-vertical-nav_v240827-e29549f0.js";import{p,q as h,r as R,s as k,t as x}from"./vuetify-dae2a577.js";import"./ag-grid-community-afd81849.js";import{A as L}from"./ag-grid-vue3-6356d667.js";import"./@iconify-319cce74.js";import"./vue-router-7b799585.js";import"./axios-9d43f49d.js";import"./apexcharts-clevision-bbcd5403.js";import"./axios-mock-adapter-5e48edef.js";import"./fast-deep-equal-6efe4724.js";import"./is-buffer-7d84b7d6.js";import"./vue-demi-71ba0ef2.js";import"./vue-e8b4e3e8.js";import"./vue3-perfect-scrollbar-ac907acf.js";import"./perfect-scrollbar-c9c56521.js";import"./@vueuse-36fea5a4.js";const A=F("updateTime",()=>{const n=u(null),i=u(null),r=u(null);return{timeBasedDetection:n,todayDetection:i,detectionCategory:r,setTimeBasedDetectionUpdateTime:s=>{n.value=s},setTodayDetectionUpdateTime:s=>{i.value=s},setDetectionCategoryUpdateTime:s=>{r.value=s}}});const M={__name:"DetectionCategoryChart",setup(n){const r=S().getAxiosInstance();let c=null;const f=A(),o=u([{data:[0,0,0,0,0]}]),s=u({chart:{height:350,type:"bar",events:{click:function(a,v,C){}}},colors:["#FF6B6B","#4ECDC4","#45B7D1","#FFA07A","#98D8C8"],plotOptions:{bar:{columnWidth:"45%",distributed:!0}},dataLabels:{enabled:!1},legend:{show:!1},xaxis:{categories:[["John","Doe"],["Joe","Smith"],["Jake","Williams"],["Peter","Brown"],["Mary","Evans"]],labels:{style:{colors:["#FF6B6B","#4ECDC4","#45B7D1","#FFA07A","#98D8C8"],fontSize:"12px"}}}});async function d(){const a=await r.get("count-by-risk-detail");o.value[0].data=Object.values(a.data.data.emailCountByRiskDetail),s.value={...s.value,xaxis:{...s.value.xaxis,categories:Object.keys(a.data.data.emailCountByRiskDetail)}},console.log(a.data.data),f.setDetectionCategoryUpdateTime(a.data.data.lastUpdateTime)}return b(()=>{d(),c=setInterval(d,1e4)}),z(()=>{c&&clearInterval(c)}),(a,v)=>(y(),w(h,null,{default:t(()=>[e(p,{cols:"12",class:"pt-0"},{default:t(()=>[e(l(T),{type:"bar",options:l(s),series:l(o)},null,8,["options","series"])]),_:1})]),_:1}))}},P=D(M,[["__scopeId","data-v-5fcc2f16"]]),$={};function G(n,i){return y(),w(h,{justify:"center",class:"h-100"},{default:t(()=>[e(p,{cols:"12"},{default:t(()=>[e(R,{type:"table"})]),_:1}),e(k,{position:"absolute",style:{top:"30%",left:"50%"},elevation:"20",class:"loader d-flex justify-center align-center text-h6 py-4 px-10",rounded:""},{default:t(()=>[g(" 로딩중 ")]),_:1})]),_:1})}const W=D($,[["render",G]]);const H={__name:"agGridTable",props:{rowData:{type:Array,default:()=>[]},colDefs:{type:Array,default:()=>[]},headerHeight:{type:Number,default:35},paginationPageSize:{type:Number,default:15},paginationPageSizeSelector:{type:Array,default:()=>[15,20,30,40,50]},loadingMessage:{type:String,default:"로딩 중..."},fetchData:{type:Function,required:!0},onCellDoubleClick:{type:Function,default:null},height:{type:String,default:null}},emits:["gridReady"],setup(n,{emit:i}){const r=n,c=a=>{a.api.autoSizeAllColumns(),a.api.showLoadingOverlay(),i("gridReady",a)},f=a=>{r.onCellDoubleClick&&r.onCellDoubleClick(a)},o=()=>{const a={gridReady:c};return r.onCellDoubleClick&&(a.cellDoubleClicked=f),a};b(()=>{r.fetchData()});const s=u(W),d=u({loadingMessage:r.loadingMessage});return(a,v)=>(y(),w(h,null,{default:t(()=>[e(p,{cols:"12",class:"pt-0"},{default:t(()=>[e(l(L),V({"auto-size-strategy":{type:"fitGridWidth"},"auto-size-padding":5,"row-data":n.rowData,"column-defs":n.colDefs,"header-height":n.headerHeight,style:{height:n.height||"calc(100vh - 15rem)"},class:"ag-theme-quartz mt-4","row-selection":"single",pagination:"true","pagination-page-size":n.paginationPageSize,"pagination-page-size-selector":n.paginationPageSizeSelector,"loading-overlay-component":l(s),"loading-overlay-component-params":l(d)},E(o())),null,16,["row-data","column-defs","header-height","style","pagination-page-size","pagination-page-size-selector","loading-overlay-component","loading-overlay-component-params"])]),_:1})]),_:1}))}},Y=D(H,[["__scopeId","data-v-c4865e18"]]);const q={__name:"RiskEmailList",setup(n){let i=null;const c=S().getAxiosInstance(),f=u([]),o=u([{headerName:"제목",field:"title",headerClass:"font-size-9 font-weight-bold",cellStyle:{"text-align":"center"}},{headerName:"위험도",field:"riskLevel",headerClass:"font-size-9 font-weight-bold",cellStyle:{"text-align":"center"}},{headerName:"위험유형",field:"riskDetail",headerClass:"font-size-9 font-weight-bold",cellStyle:{"text-align":"center"}},{headerName:"차단일자",field:"detectionDate",headerClass:"font-size-9 font-weight-bold",cellStyle:{"text-align":"center"}}]),s=async()=>{try{const d=await c.get("last-10-blocked-emails");f.value=d.data.data.emails}catch(d){console.error("Error fetching data:",d)}};return b(()=>{s(),i=setInterval(s,1e4)}),z(()=>{i&&clearInterval(i)}),(d,a)=>(y(),w(h,null,{default:t(()=>[e(p,{cols:"12"},{default:t(()=>[e(Y,{"row-data":l(f),"col-defs":l(o),height:"calc(100vh - 39rem)","pagination-page-size":5,"pagination-page-size-selector":[5],"loading-message":"데이터 로딩 중...","fetch-data":s},null,8,["row-data","col-defs"])]),_:1})]),_:1}))}};const J={__name:"TimeBasedDetection",setup(n){const r=S().getAxiosInstance();let c=null;const f=A(),o=u([{name:"금일",data:[0,0,0,0,0,0,0,0,0,0]},{name:"전일",data:[0,0,0,0,0,0,0,0,0,0]}]),s=u({chart:{height:350,type:"area",toolbar:{show:!1}},dataLabels:{enabled:!1},stroke:{curve:"smooth"},xaxis:{type:"time",categories:["09:00","10:00","11:00","12:00","13:00","14:00","15:00","16:00","17:00","18:00"]},tooltip:{x:{format:"HH:mm"}}}),d=async()=>{try{const a=await r.get("hourly-detected-emails");o.value[0].data=a.data.data.series[0].data,o.value[1].data=a.data.data.series[1].data;const v=a.data.data.categories.map(C=>C.split(" ")[1]);s.value={...s.value,xaxis:{...s.value.xaxis,categories:v}},f.setTimeBasedDetectionUpdateTime(a.data.data.lastUpdateTime)}catch(a){console.error("Error fetching data:",a)}};return b(()=>{d(),c=setInterval(d,7e3)}),z(()=>{c&&clearInterval(c)}),(a,v)=>(y(),w(h,null,{default:t(()=>[e(p,{cols:"12",class:"pt-0"},{default:t(()=>[e(l(T),{type:"area",options:l(s),series:l(o)},null,8,["options","series"])]),_:1})]),_:1}))}},X=D(J,[["__scopeId","data-v-96bd2aa8"]]),K={xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 24 24"},Q=N('<g fill="none" stroke="currentColor" stroke-dasharray="12" stroke-dashoffset="12" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.6"><path d="M22 12l-7 -7M22 12l-7 7"><animate fill="freeze" attributeName="stroke-dashoffset" dur="0.3s" values="12;0"></animate></path><path d="M16 12l-7 -7M16 12l-7 7"><animate fill="freeze" attributeName="stroke-dashoffset" begin="0.3s" dur="0.3s" values="12;0"></animate></path><path d="M10 12l-7 -7M10 12l-7 7"><animate fill="freeze" attributeName="stroke-dashoffset" begin="0.6s" dur="0.3s" values="12;0"></animate></path></g>',1),Z=[Q],ee=O({__name:"TripleArrow",setup(n){return(i,r)=>(y(),j("svg",K,Z))}});const te={__name:"TodayDetection",setup(n){const r=S().getAxiosInstance(),c=A();let f=null;const o=u({total:0,detected:0,blocked:0}),s=I(()=>[o.value.detected,o.value.total-o.value.detected]),d=u({chart:{type:"donut"},dataLabels:{enabled:!1},legend:{show:!1},plotOptions:{pie:{startAngle:0,endAngle:360,expandOnClick:!0,offsetX:0,offsetY:0,customScale:1,donut:{labels:{show:!0,total:{show:!0,showAlways:!0,label:"탐지",fontWeight:600,fontFamily:"Pretendard Variable",fontSize:"1.2rem",formatter:function(m){return o.value.detected}},value:{show:!0,fontWeight:600,fontFamily:"Pretendard Variable",fontSize:"1rem",offsetY:0}}}}},labels:["탐지",""],colors:["#70dc61","#00000020"],responsive:[{breakpoint:480,options:{chart:{width:200}}}]}),a=I(()=>[o.value.blocked,o.value.detected-o.value.blocked]),v=u({chart:{type:"donut"},dataLabels:{enabled:!1},legend:{show:!1},plotOptions:{pie:{startAngle:0,endAngle:360,expandOnClick:!0,offsetX:0,offsetY:0,donut:{labels:{show:!0,total:{show:!0,showAlways:!0,label:"차단",fontWeight:600,fontFamily:"Pretendard Variable",fontSize:"1rem",formatter:function(m){return o.value.blocked}},value:{show:!0,fontWeight:600,fontFamily:"Pretendard Variable",fontSize:"1rem",offsetY:0}}}}},labels:["탐지",""],colors:["#C13030","#00000020"],responsive:[{breakpoint:480,options:{chart:{width:200}}}]}),C=async()=>{try{const m=await r.get("today-detected-emails");o.value.total=m.data.data.totalEmails,o.value.detected=m.data.data.highRiskEmails,o.value.blocked=m.data.data.blockedHighRiskEmails,c.setTodayDetectionUpdateTime(m.data.data.lastUpdateTime)}catch(m){console.error("Error fetching data:",m)}};return b(()=>{C(),f=setInterval(C,5e3)}),z(()=>{f&&clearInterval(f)}),(m,me)=>(y(),w(h,{"no-gutters":""},{default:t(()=>[e(p,{cols:"6",class:"d-flex align-center justify-center"},{default:t(()=>[e(l(T),{type:"donut",width:"100%",options:l(d),series:l(s)},null,8,["options","series"])]),_:1}),e(p,{cols:"1",class:"d-flex align-center justify-center pa-0"},{default:t(()=>[e(ee,{style:{width:"100px",height:"100px"}})]),_:1}),e(p,{cols:"5",class:"d-flex align-center justify-center"},{default:t(()=>[e(l(T),{type:"donut",width:"100%",options:l(v),series:l(a)},null,8,["options","series"])]),_:1})]),_:1}))}},ae=D(te,[["__scopeId","data-v-fed42a6b"]]);const oe={class:"d-flex align-center justify-center"},se={class:"d-flex align-center justify-center flex-grow-1"},le={class:"d-flex align-center justify-center"},ne={class:"d-flex align-center justify-center"},ie={class:"d-flex align-center justify-center flex-grow-1"},re={class:"d-flex align-center justify-center"},ce={class:"d-flex align-center justify-center"},de={class:"d-flex align-center justify-center flex-grow-1"},ue={class:"d-flex align-center justify-center"},fe={class:"d-flex align-center justify-center"},pe={class:"d-flex align-center justify-center flex-grow-1"},_e={__name:"dashboard",setup(n){S();const i=A();return b(()=>{}),(r,c)=>(y(),j(U,null,[e(h,null,{default:t(()=>[e(p,{sm:"12",md:"4",class:"d-flex flex-column"},{default:t(()=>[e(k,{class:"pa-4 elevation-12 rounded flex-grow-1 d-flex flex-column"},{default:t(()=>[_("div",oe,[e(x,{style:{"font-size":"1.2rem","font-weight":"700",color:"#00000095"}},{default:t(()=>[g("금일 탐지/차단 현황")]),_:1})]),_("div",se,[e(ae)]),_("div",le,[e(x,{style:{"font-size":"0.9rem","font-weight":"700",color:"#00000075"}},{default:t(()=>[g(" 마지막 업데이트 시간: "+B(l(i).todayDetection),1)]),_:1})])]),_:1})]),_:1}),e(p,{sm:"12",md:"4",class:"d-flex flex-column"},{default:t(()=>[e(k,{class:"pa-4 elevation-12 rounded flex-grow-1"},{default:t(()=>[_("div",ne,[e(x,{style:{"font-size":"1.2rem","font-weight":"700",color:"#00000095"}},{default:t(()=>[g("금일/전일 위협메일 탐지 추이")]),_:1})]),_("div",ie,[e(X)]),_("div",re,[e(x,{style:{"font-size":"0.9rem","font-weight":"700",color:"#00000075"}},{default:t(()=>[g(" 마지막 업데이트 시간: "+B(l(i).timeBasedDetection),1)]),_:1})])]),_:1})]),_:1}),e(p,{sm:"12",md:"4",class:"d-flex flex-column"},{default:t(()=>[e(k,{class:"pa-4 elevation-12 rounded flex-grow-1"},{default:t(()=>[_("div",ce,[e(x,{style:{"font-size":"1.2rem","font-weight":"700",color:"#00000095"}},{default:t(()=>[g("금일 위협메일 유형별 통계")]),_:1})]),_("div",de,[e(P)]),_("div",ue,[e(x,{style:{"font-size":"0.9rem","font-weight":"700",color:"#00000075"}},{default:t(()=>[g(" 마지막 업데이트 시간: "+B(l(i).detectionCategory),1)]),_:1})])]),_:1})]),_:1})]),_:1}),e(h,null,{default:t(()=>[e(p,{sm:"12",md:"7",class:"d-flex flex-column"},{default:t(()=>[e(k,{class:"pa-4 elevation-12 rounded flex-grow-1 d-flex flex-column"},{default:t(()=>[_("div",fe,[e(x,{style:{"font-size":"1.2rem","font-weight":"700",color:"#00000095"}},{default:t(()=>[g("실시간 차단 메일 리스트")]),_:1})]),_("div",pe,[e(q)])]),_:1})]),_:1})]),_:1})],64))}},Oe=D(_e,[["__scopeId","data-v-f660753d"]]);export{Oe as default};
